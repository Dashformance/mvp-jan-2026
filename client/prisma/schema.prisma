generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id            String   @id @default(uuid())
  name          String
  email         String   @unique
  password_hash String
  created_at    DateTime @default(now())
}

model Segment {
  id          String   @id @default(uuid())
  name        String
  description String?
  created_at  DateTime @default(now())
  leads       Lead[]
}

model Lead {
  id                 String     @id @default(uuid())
  company_name       String?
  trade_name         String?
  cnpj               String?    @unique
  phone              String?
  email              String?
  instagram_url      String?
  website_url        String?
  render_quality     String?    // Enum-like: GOOD, MEDIUM, BAD
  decision_maker     String?
  extra_info         Json?
  segment_id         String?
  status             LeadStatus @default(NEW)
  priority           Int        @default(0)
  date_added         DateTime   @default(now())
  first_contact_date DateTime?
  last_contact_date  DateTime?
  next_followup_date DateTime?
  notes              String?
  owner              String?
  uf                 String?
  city               String?
  deletedAt          DateTime?
  source             String?    // Fonte: extracao, instagram, rede_joao, rede_vitor
  score              Int        @default(0)  // Pontuação calculada
  segment            Segment?   @relation(fields: [segment_id], references: [id])

  @@map("leads")
}

enum LeadStatus {
  // Triagem
  INBOX          // Lead cru (Casa dos Dados)
  SCREENING      // Em análise pelo arquiteto
  
  // Pipeline de Vendas  
  NEW            // Qualificado, pronto para contato
  ATTEMPTED
  CONTACTED
  MEETING
  WON
  LOST
  DISQUALIFIED
}
